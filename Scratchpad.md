# Scratchpad

このファイルはタスクの計画と進捗状況を追跡するために使用します。

## 現在のタスク

スマートフォンのカメラを使って心拍を測定するWebアプリの作成

### 測定原理
- Photoplethysmography (PPG): 血流量変化による光の反射率の違いを検出
- 必要に応じてEulerian Video Magnification (EVM)を組み合わせる

### 測定手法
1. カメラ非接触（普通の撮影）方式
   - カメラで肌を撮影し、その色を測定
   - 血流量変化による光の反射率の違いを検出

2. カメラ接触方式
   - 指をカメラに軽く置き、反射する光の微細な変化を分析
   - 可能であればフラッシュを使用

### 実装計画
- [X] プロジェクト構造の設定
- [X] 基本コンポーネントの実装
  - [X] メインコンポーネント（HeartRateMonitor）
  - [X] 表示コンポーネント（HeartRateDisplay）
  - [X] カメラビューコンポーネント（CameraView）
  - [X] モード選択コンポーネント（DetectionModeSelector）
- [X] カメラアクセスとストリーム取得の実装（useCameraStream）
- [X] 画像処理アルゴリズムの実装
  - [X] PPG実装 (指をカメラに置く方式)
  - [X] 非接触方式の実装
  - [X] EVM手法の準備
- [X] 心拍数計算ロジックの実装
- [X] HTMLとエントリポイント作成
- [ ] テストと最適化

## 進捗状況
基本的な実装は完了しました。主要なコンポーネントとロジックが実装され、アプリのUIも整いました。

## メモと反省
- PPG（光電容積脈波）の原理を使って指の血流変化を検出
- カメラの赤色チャンネルが血液の脈動を検出するのに最も効果的
- 信頼度の計算は改善の余地あり
- より高度な信号処理（FFTなど）を追加することで精度向上が可能 