# 控除証明書XML閲覧ツール

日本の控除証明書データのXMLファイルを閲覧する読み取り専用のウェブアプリケーションです。

## 機能

- XMLファイルのアップロード（ドラッグ&ドロップ対応）
- XML構造のツリービュー表示（XML閲覧タブ）
- XSDベースの簡易帳票表示（XML簡易帳票タブ）
  - XSDスキーマから自動的に要素マッピングを生成
  - 日本語項目名での表示
  - カテゴリ別のグループ化
  - 階層構造の保持
- 要素の展開/折りたたみ
- 属性値の表示
- テキストノードの表示

## 使用方法

1. アプリケーションを起動します
2. XMLファイルをドラッグ&ドロップするか、クリックしてファイルを選択します
3. 「XML閲覧」タブでXMLの構造がツリービュー形式で表示されます
4. 「XML簡易帳票」タブでXSDベースの簡易帳票が表示されます（対応TEGコードの場合）
5. 各要素をクリックして展開/折りたたみができます

## 対応TEGコード

以下の13種類のTEGコードに対応しています（XSDファイルが存在するすべてのTEGコード）：

### 給与所得の源泉徴収票

- **TEG104**: 平成\_\_年分　給与所得の源泉徴収票(平成28年以降用)
- **TEG105**: 年分　給与所得の源泉徴収票(平成30年以降用)
- **TEG106**: 年分　給与所得の源泉徴収票(令和2年以降用)
- **TEG107**: 年分　給与所得の源泉徴収票(令和4年以降用)
- **TEG108**: 年分　給与所得の源泉徴収票(令和5年以降用)

### 控除証明書

- **TEG800**: 生命保険料控除証明書
- **TEG810**: 地震保険料控除証明書
- **TEG840**: 国民年金保険料等控除証明書
- **TEG850**: 小規模企業共済等掛金控除証明書

### 寄附金関連

- **TEG820**: 寄附金受領証明書
- **TEG821**: 寄附金受領証明書(複数寄附対応用)
- **TEG822**: 寄附金受領証明書(令和3年分以降複数寄附対応用)
- **TEG830**: 寄附金控除に関する証明書

## 技術スタック

- React 18.2.0
- TypeScript 5.7.3
- MUI 6.4.5
- fast-xml-parser（XMLパース）
- @xmldom/xmldom（XSDパース）
- xpath（XPathクエリ）

## データソース

本ツールで使用している`kojoall/04XMLスキーマ`フォルダ内のXSDファイルは、[国税庁のe-Tax仕様書一覧ページ](https://www.e-tax.nta.go.jp/shiyo/shiyo-kojo3.htm)で公開されている「XMLスキーマ」仕様書（CAB形式）から取得したものです。

## サンプルデータ

`sample`フォルダには、[マイナポータル連携APIについて](https://www.nta.go.jp/taxes/tetsuzuki/mynumberinfo/mnp_question/kaikei_question/api/about.htm)で公開されている社会保険料控除証明書データ（TEG840）のサンプルデータが含まれています：

- サンプルデータ①*TEG840*パターン１（前納&一括）.xml
- サンプルデータ②*TEG840*パターン２（前納&分割(R4データ)）.xml
- サンプルデータ③*TEG840*パターン２（前納&分割(R5データ)）.xml
- サンプルデータ④*TEG840*パターン２（前納&分割(R6データ)）.xml
- サンプルデータ⑤*TEG840*パターン3（一括（前納なし）(R6データ)）.xml
- サンプルデータ⑥\_パターン4（一括＆半年前納&見込額有）.xml
- TEG800\_生命保険料控除証明書\_202511月.xml （これは独自に作成したデータ）

## 仕様書

`kojoall/03CSV変換モジュールインターフェイス仕様書【電子的控除証明書等】`フォルダには、CSV変換モジュールインターフェイス仕様書が含まれています。このフォルダ内の`property`サブフォルダには、各TEGコードのテンプレートファイル（`*_tpl.xml`）とバリデーションファイル（`*_vld.xml`）が格納されています。

## 参考資料

- [電子的控除証明書等に係る仕様書一覧](https://www.e-tax.nta.go.jp/shiyo/shiyo-kojo3.htm)
- [控除申告書データに係る仕様書](https://www.nta.go.jp/users/gensen/oshirase/0019004-159.htm)
- [マイナポータル連携APIについて](https://www.nta.go.jp/taxes/tetsuzuki/mynumberinfo/mnp_question/kaikei_question/api/about.htm)

## 免責事項

**重要**: 本ツールは以下の点についてご注意ください。

1. **プライバシーとセキュリティ**: 本ツールはXMLファイルの外部送信を行いません。すべての処理はクライアントサイド（お使いの端末上）で実行され、XMLファイルの内容はサーバーに送信されることはありません。

2. **署名の検証**: 本ツールはXMLファイルのデジタル署名（XML Signature）の検証を行いません。署名の検証が必要な場合は、別途適切なツールをご使用ください。

3. **簡易帳票のフォーマット**: 「XML簡易帳票」タブで表示される帳票フォーマットは、本ツール独自のものです。正式な控除証明書のフォーマットとは異なります。

4. **内容の保証**: 本ツール上で表示される内容について一切の保証をいたしません。表示される情報の正確性、完全性、有用性について、いかなる責任も負いません。

5. **区分値の表示**: 特例事由申出表示など、元データで値が用意されていない区分項目については、XSDスキーマに定義された区分コードがそのまま数値で表示される場合があります。区分名への変換は、XSDスキーマに区分名の定義がある場合のみ行われます。

6. **使用目的**: 本ツールは参考・確認目的でのみ使用してください。
